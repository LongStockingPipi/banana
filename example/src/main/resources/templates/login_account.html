<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"></meta>
    <title>banana security framework</title>
</head>
<body>

    <h1>login page</h1>

    <form>
        用户名：<input type="text" name="username" id="username" value="qwert"/>
        密码：<input type="password" name="password" id="passwd" value="123456"/>
        图形验证码：<input type="text" name="validateCode_image" id="validateCode_image" />
        <img src="/captcha/image"/>
        <input type="button" value="login" th:onclick="'javascript:login()'"/>
    </form>


</body>
    <script type="text/javascript" th:src="@{/webjars/jquery/3.3.1-2/jquery.min.js}"></script>
<!--    <script type="text/javascript" th:src="@{/static/login.js}"></script>-->
    <script th:inline="javascript">
    /*<![CDATA[*/


    function login() {
        let username = $("#username").val();
        let passwd = $("#passwd").val();
        let code = $("#validateCode_image").val();

        console.info("code: " + code)
        if(null == username || '' == username || username.length < 1) {
            alert("username can not ne null");
            return;
        }

        if(null == passwd || '' == passwd || passwd.length < 1) {
            alert("username can not ne null");
            return;
        }

        if(null == code || '' == code || code.length < 1) {
            alert("code can not ne null");
            return;
        }

        let url = '/api/auth/account';
        $.post(url, {username: username, password: passwd, validate_code: code}, function (data) {
            console.info(data);
            if(data.success == true) {
                window.location.href = "/page/index";
            } else {
                alert('login failed!');
            }
        })
    }

    /*]]>*/
    </script>
</html>